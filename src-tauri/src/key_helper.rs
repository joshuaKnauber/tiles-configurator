use enigo::{Enigo, KeyboardControllable, Key};

pub fn string_to_key(key_str: &str) -> Key {
    let key = match key_str {
        "Num0" => Key::Num0,
        "Num1" => Key::Num1,
        "Num2" => Key::Num2,
        "Num3" => Key::Num3,
        "Num4" => Key::Num4,
        "Num5" => Key::Num5,
        "Num6" => Key::Num6,
        "Num7" => Key::Num7,
        "Num8" => Key::Num8,
        "Num9" => Key::Num9,
        "A" => Key::A,      
        "B" => Key::B,      
        "C" => Key::C,      
        "D" => Key::D,      
        "E" => Key::E,      
        "F" => Key::F,      
        "G" => Key::G,      
        "H" => Key::H,      
        "I" => Key::I,      
        "J" => Key::J,      
        "K" => Key::K,      
        "L" => Key::L,      
        "M" => Key::M,      
        "N" => Key::N,      
        "O" => Key::O,      
        "P" => Key::P,
        "Q" => Key::Q,
        "R" => Key::R,
        "S" => Key::S,
        "T" => Key::T,
        "U" => Key::U,
        "V" => Key::V,
        "W" => Key::W,
        "X" => Key::X,
        "Y" => Key::Y,
        "Z" => Key::Z,
        "AbntC1" => Key::AbntC1,
        "AbntC2" => Key::AbntC2,
        "Accept" => Key::Accept,
        "Add" => Key::Add,
        "Alt" => Key::Alt,
        "Apps" => Key::Apps,
        "Attn" => Key::Attn,
        "Backspace" => Key::Backspace,
        "BrowserBack" => Key::BrowserBack,
        "BrowserFavorites" => Key::BrowserFavorites,
        "BrowserForward" => Key::BrowserForward,
        "BrowserHome" => Key::BrowserHome,
        "BrowserRefresh" => Key::BrowserRefresh,
        "BrowserSearch" => Key::BrowserSearch,
        "BrowserStop" => Key::BrowserStop,
        "Cancel" => Key::Cancel,
        "CapsLock" => Key::CapsLock,
        "Clear" => Key::Clear,
        "Control" => Key::Control,
        "Convert" => Key::Convert,
        "Crsel" => Key::Crsel,
        "DBEAlphanumeric" => Key::DBEAlphanumeric,
        "DBECodeinput" => Key::DBECodeinput,
        "DBEDetermineString" => Key::DBEDetermineString,
        "DBEEnterDLGConversionMode" => Key::DBEEnterDLGConversionMode,
        "DBEEnterIMEConfigMode" => Key::DBEEnterIMEConfigMode,
        "DBEEnterWordRegisterMode" => Key::DBEEnterWordRegisterMode,
        "DBEFlushString" => Key::DBEFlushString,
        "DBEHiragana" => Key::DBEHiragana,
        "DBEKatakana" => Key::DBEKatakana,
        "DBENoCodepoint" => Key::DBENoCodepoint,
        "DBENoRoman" => Key::DBENoRoman,
        "DBERoman" => Key::DBERoman,
        "DBESBCSChar" => Key::DBESBCSChar,
        "DBESChar" => Key::DBESChar,
        "Decimal" => Key::Decimal,
        "Delete" => Key::Delete,
        "Divide" => Key::Divide,
        "DownArrow" => Key::DownArrow,
        "End" => Key::End,
        "Ereof" => Key::Ereof,
        "Escape" => Key::Escape,
        "Execute" => Key::Execute,
        "Exsel" => Key::Exsel,
        "F1" => Key::F1,
        "F2" => Key::F2,
        "F3" => Key::F3,
        "F4" => Key::F4,
        "F5" => Key::F5,
        "F6" => Key::F6,
        "F7" => Key::F7,
        "F8" => Key::F8,
        "F9" => Key::F9,
        "F10" => Key::F10,
        "F11" => Key::F11,
        "F12" => Key::F12,
        "F13" => Key::F13,
        "F14" => Key::F14,
        "F15" => Key::F15,
        "F16" => Key::F16,
        "F17" => Key::F17,
        "F18" => Key::F18,
        "F19" => Key::F19,
        "F20" => Key::F20,
        "F21" => Key::F21,
        "F22" => Key::F22,
        "F23" => Key::F23,
        "F24" => Key::F24,
        "Final" => Key::Final,
        "GamepadA" => Key::GamepadA,
        "GamepadB" => Key::GamepadB,
        "GamepadDPadDown" => Key::GamepadDPadDown,
        "GamepadDPadLeft" => Key::GamepadDPadLeft,
        "GamepadDPadRight" => Key::GamepadDPadRight,
        "GamepadDPadUp" => Key::GamepadDPadUp,
        "GamepadLeftShoulder" => Key::GamepadLeftShoulder,
        "GamepadLeftThumbstickButton" => Key::GamepadLeftThumbstickButton,
        "GamepadLeftThumbstickDown" => Key::GamepadLeftThumbstickDown,
        "GamepadLeftThumbstickLeft" => Key::GamepadLeftThumbstickLeft,
        "GamepadLeftThumbstickRight" => Key::GamepadLeftThumbstickRight,
        "GamepadLeftThumbstickUp" => Key::GamepadLeftThumbstickUp,
        "GamepadLeftTrigger" => Key::GamepadLeftTrigger,
        "GamepadMenu" => Key::GamepadMenu,
        "GamepadRightShoulder" => Key::GamepadRightShoulder,
        "GamepadRightThumbstickButton" => Key::GamepadRightThumbstickButton,
        "GamepadRightThumbstickDown" => Key::GamepadRightThumbstickDown,
        "GamepadRightThumbstickLeft" => Key::GamepadRightThumbstickLeft,
        "GamepadRightThumbstickRight" => Key::GamepadRightThumbstickRight,
        "GamepadRightThumbstickUp" => Key::GamepadRightThumbstickUp,
        "GamepadRightTrigger" => Key::GamepadRightTrigger,
        "GamepadView" => Key::GamepadView,
        "GamepadX" => Key::GamepadX,
        "GamepadY" => Key::GamepadY,
        "Hangul" => Key::Hangul,
        "Hanja" => Key::Hanja,
        "Help" => Key::Help,
        "Home" => Key::Home,
        "Ico00" => Key::Ico00,
        "IcoClear" => Key::IcoClear,
        "IcoHelp" => Key::IcoHelp,
        "IMEOff" => Key::IMEOff,
        "IMEOn" => Key::IMEOn,
        "Insert" => Key::Insert,
        "Junja" => Key::Junja,
        "Kana" => Key::Kana,
        "Kanji" => Key::Kanji,
        "LaunchApp1" => Key::LaunchApp1,
        "LaunchApp2" => Key::LaunchApp2,
        "LaunchMail" => Key::LaunchMail,
        "LaunchMediaSelect" => Key::LaunchMediaSelect,
        "LButton" => Key::LButton,
        "LControl" => Key::LControl,
        "LeftArrow" => Key::LeftArrow,
        "LMenu" => Key::LMenu,
        "LShift" => Key::LShift,
        "LWin" => Key::LWin,
        "MButton" => Key::MButton,
        "MediaNextTrack" => Key::MediaNextTrack,
        "MediaPlayPause" => Key::MediaPlayPause,
        "MediaPrevTrack" => Key::MediaPrevTrack,
        "MediaStop" => Key::MediaStop,
        "Meta" => Key::Meta,
        "ModeChange" => Key::ModeChange,
        "Multiply" => Key::Multiply,
        "NavigationAccept" => Key::NavigationAccept,
        "NavigationCancel" => Key::NavigationCancel,
        "NavigationDown" => Key::NavigationDown,
        "NavigationLeft" => Key::NavigationLeft,
        "NavigationMenu" => Key::NavigationMenu,
        "NavigationRight" => Key::NavigationRight,
        "NavigationUp" => Key::NavigationUp,
        "NavigationView" => Key::NavigationView,
        "NoName" => Key::NoName,
        "NonConvert" => Key::NonConvert,
        "None" => Key::None,
        "Numlock" => Key::Numlock,
        "Numpad0" => Key::Numpad0,
        "Numpad1" => Key::Numpad1,
        "Numpad2" => Key::Numpad2,
        "Numpad3" => Key::Numpad3,
        "Numpad4" => Key::Numpad4,
        "Numpad5" => Key::Numpad5,
        "Numpad6" => Key::Numpad6,
        "Numpad7" => Key::Numpad7,
        "Numpad8" => Key::Numpad8,
        "Numpad9" => Key::Numpad9,
        "OEM1" => Key::OEM1,
        "OEM102" => Key::OEM102,
        "OEM2" => Key::OEM2,
        "OEM3" => Key::OEM3,
        "OEM4" => Key::OEM4,
        "OEM5" => Key::OEM5,
        "OEM6" => Key::OEM6,
        "OEM7" => Key::OEM7,
        "OEM8" => Key::OEM8,
        "OEMAttn" => Key::OEMAttn,
        "OEMAuto" => Key::OEMAuto,
        "OEMAx" => Key::OEMAx,
        "OEMBacktab" => Key::OEMBacktab,
        "OEMClear" => Key::OEMClear,
        "OEMComma" => Key::OEMComma,
        "OEMCopy" => Key::OEMCopy,
        "OEMCusel" => Key::OEMCusel,
        "OEMEnlw" => Key::OEMEnlw,
        "OEMFinish" => Key::OEMFinish,
        "OEMFJJisho" => Key::OEMFJJisho,
        "OEMFJLoya" => Key::OEMFJLoya,
        "OEMFJMasshou" => Key::OEMFJMasshou,
        "OEMFJRoya" => Key::OEMFJRoya,
        "OEMFJTouroku" => Key::OEMFJTouroku,
        "OEMJump" => Key::OEMJump,
        "OEMMinus" => Key::OEMMinus,
        "OEMNECEqual" => Key::OEMNECEqual,
        "OEMPA1" => Key::OEMPA1,
        "OEMPA2" => Key::OEMPA2,
        "OEMPA3" => Key::OEMPA3,
        "OEMPeriod" => Key::OEMPeriod,
        "OEMPlus" => Key::OEMPlus,
        "OEMReset" => Key::OEMReset,
        "OEMWsctrl" => Key::OEMWsctrl,
        "Option" => Key::Option,
        "PA1" => Key::PA1,
        "Packet" => Key::Packet,
        "PageDown" => Key::PageDown,
        "PageUp" => Key::PageUp,
        "Pause" => Key::Pause,
        "Play" => Key::Play,
        "Print" => Key::Print,
        "Processkey" => Key::Processkey,
        "RButton" => Key::RButton,
        "RControl" => Key::RControl,
        "Return" => Key::Return,
        "RightArrow" => Key::RightArrow,
        "RMenu" => Key::RMenu,
        "RShift" => Key::RShift,
        "RWin" => Key::RWin,
        "Scroll" => Key::Scroll,
        "Select" => Key::Select,
        "Separator" => Key::Separator,
        "Shift" => Key::Shift,
        "Sleep" => Key::Sleep,
        "Snapshot" => Key::Snapshot,
        "Space" => Key::Space,
        "Subtract" => Key::Subtract,
        "Tab" => Key::Tab,
        "UpArrow" => Key::UpArrow,
        "VolumeDown" => Key::VolumeDown,
        "VolumeMute" => Key::VolumeMute,
        "VolumeUp" => Key::VolumeUp,
        "XButton1" => Key::XButton1,
        "XButton2" => Key::XButton2,
        "Zoom" => Key::Zoom,
        _ => Key::None,
    };

    key
}

pub fn run_key_string(key_str: &str) {
    if key_str.len() < 2 { return; }

    let keys = key_str.split(";").collect::<Vec<&str>>();
    
    let mut enigo = Enigo::new();
    for key in keys {
        println!("{}", key);
        match key.chars().nth(0).unwrap().to_string().as_str() {
            "+" => enigo.key_down(string_to_key(&key[1..])),
            "-" => enigo.key_up(string_to_key(&key[1..])),
            _ => enigo.key_click(string_to_key(key)),
        }
    }
}